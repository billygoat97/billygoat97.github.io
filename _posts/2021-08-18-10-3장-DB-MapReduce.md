---
title: "데이터베이스(DB) 10-3장 맵리듀스"
except: "데이터베이스(DB) 에서 빅 데이터를 가공 및 분류하는 맵리듀스에 대해 알아보자."
categories:
  - 데이터베이스
tags:
  - 하둡
  - 잡트래커
  - 태스크트래커
  - Map
  - Reduce
toc: true
toc_sticky: true
---

# 10-3장 Map Reduce (맵 리듀스)
## <span style = "color:powderblue"> ※ 하둡 에코시스템의 코어 프로젝트인 Map Reduce란?

### <span style = "color:powderblue"> ※ 맵 리듀스 개념
- 맵 리듀스는 프레임워크임
- 맵 리듀스를 이용하면 대규모 분산 컴퓨팅 혹은 단일 컴퓨팅 환경에서 개발자가 대량의 데이터를 병렬 분석 가능
- 개발자가 맵 리듀스 알고리즘에 맞게 개발시 데이터 입출력 병렬처리등의 작업을 프레임워크가 알아서 처리해 줌
- 맵 리듀스는 말 그대로 MAP / REDUCE 이렇게 두가지로 나뉨

- MAP; list(k1,v1) => list(k2,v2)
	- 맵 메서드는 키(k1)와 값(v1)으로 구성된 목록을 입력받아, 가공, 분류하여 새로운 키(k2)와 값(v2)으로 구성된 목록 출력
	- 계속해서 메서드가 수행되면 새로운 키(k2)를 가지는 여러개의 값(v2들이 많음)이 생성, 새로운 키(k2)로 그룹핑된 값의 목록(list(v2))을 리듀스 메서드의 입력 데이터로 전달

- REDUCE; list(k,list(v2)) => list(k3,v3)
	- 리듀스 메서드는 값의 목록 (list(v2))에 대한 집계 연산을 실행해 새로운 키(k3), 값 (v3)으로  구성된 목록 생성함


- 맵 리듀스를 사용하여 read a book, write a book이라는 문장을 활용 단어의 출현빈도 분석 프로그램을 생성한다면?
![image](/images/DB-10(3)-01.png)

1. 맵 리듀스는 입력 파일을 키, 값 형식으로 분리
2. 키와 값 형식 데이터는 맵 메서드의 입력 데이터로 전달
3. 맵 데이터는 라인 번호별로 문장 체크해 단어별로 빈도수 출력
4. 맵 리듀스는 맵 메서드의 출력 데이터를 정렬, 병합
5. 4번의 결과가 리듀스 메서드의 입력 데이터로 전달
6. 리듀스 메서드는 새로운 키인 단어별로 각 단어의 빈도수를 합산 출력
7. 리듀스 출력 데이터를 HDFS 저장

즉, book 1 book 1 -> book (1,1) -> book 2 이 되는 것! //EASY

<br><br><br>

### <span style = "color:powderblue"> ※ 맵 리듀스 시스템 구성
- 맵 리듀스 시스템은 클라이언트, 잡트래커, 태스크트래커로 구성

![image](/images/DB-10(3)-02.png)

- 클라이언트는 사용자가 실행한 맵리듀스 프로그램과 하둡에서 제공하는 맵리듀스 API
- 사용자는 API로 개발, 개발 프로그램을 하둡에서 실행
- 클라이언트가 하둡에서 요청하는 맵 리듀스 프로그램을 잡이라는 하나의 작업이라 지칭
- 잡 트래커는 하둡 클러스트에 등록된 전체 잡의 스케줄링 관리, 모니터링
- 전체  하둡 클러스터에서 하나의 잡트래커 실행. 네임 노드 서버에서 보통 실행
- 새로운 잡을 요청시, 잡트래커는 몇 개의 맵, 리듀스 실행할지 계산
- 맵과 리듀스를 어떤 태스크트래커에서 실행할지 결정하여 잡을 할당
- 태크스트래커는 데이터노드에서 실행되는 데몬이며, 잡트래커가 요청한 맵과 리듀스 개수만큼 맵 태스크와 리듀스 태스크 생성
- 맵 태스크, 리듀스 태스 생성시 새로운 JVM(자바 가상 머신) 구동하여 맵 태스크, 리듀스 태스크를 실행함
- 잡 트래커와 태스트트래커는 하드비트라는 메서드로 네트워크 통신하며 태스크트래커의 상태와 작업 실행 정보 교환
- 태스크트래커에 오류 발생시 잡 트래커는 다른 태스크트래커를 찾아 태스크의 재실행 요청

<br><br><br>

### <span style = "color:powderblue"> ※ 맵 리듀스 구조에 대한 찰떡같은 비유가 떠올라서 update 한 내용(2021.08.19.)

- 클라이언트: 외주업체
- 잡 트래커: 인력소장
- 태스크 트래커: 조장
- 맵: 문과 출신 인력
- 리듀스: 이과 출신 인력
이라고 한다면,

외주업체(클라이언트)는 인력소장(잡 트래커)에게 일을 맡기고, 인력소장(잡트래커)는 얼마나 인원이 필요한지 계산을 하게 된다. 계산된 인원을 어떤 조에게 맡길지 정해서 해당 조장(태스크 트래커)에게 해당 내용을 알려준다. 조장(태스크 트래커)는 문과 인력(맵)과 이과 인력(리듀스)을 그만큼 데리고 일을 시키게 된다. 만약에 해당 조에 문제가 생기면 인력소장(잡트래커)는 다른 조장(태스크트래커)에게 일을 다시 할당하게 된다.

<br><br><br>
<br><br><br>


# <span style = "color:Yellow">**※ 핵심 내용**
## <span style = "color:Orange"> **Q1 . 맵 리듀스는 맵, 리듀스 2가지 메서드로 구성되어 있다. 맵 리듀스 메서드의 기능을 설명하고, 간단한 예시를 들어 보시오** </span>

- 맵 메서드는 키와 값으로 구성된 목록을 입력받아 이를 새로운 키와 값으로 구성된 목록을 출력한다. 여기서 공통적인 키를 갖는 값들이 있을텐데, 이를 하나의 리스트로 묶는 것까지의 과정이 맵 메서드의 주요 기능이다.

- 리듀스 메서드는 이렇게 부여받은 키와 값들의 리스트를 키와 값으로 변환시키는 과정을 의미한다.

- 예를 들면 I like cat, She like dog 라는 문장에서 단어 빈도수를 찾아볼 때, 맵 메서드를 이용하여 (I,1) (like, 1) (cat, 1) (She, 1) (like, 1) (dog 1)으로 key value가 될 수 있으며 리스트를 생성시에 (I,1) (like, {1,1}) (cat, 1) (She, 1) (dog 1)으로 변환, 그리고 리듀스 메서드를 이용할시 (I,1) (like, 2) (cat, 1) (She, 1) (dog 1)으로 변경하는 것을 의미한다.

## <span style = "color:Orange"> **Q2 . 맵 리듀스 시스템에서 맵 리듀스 메서드를 생성하고 컨트롤하는 요소들은 무엇이며 그 실행 방식에 대해 설명하시오.** </span>

- 맵 리듀스 메서드를 생성하고 컨트롤하는 것을 알기 위해서는 맵 리듀스 시스템 구성을 알아야 한다. 맵 리듀스 시스템 구성은 사용자가 이용하는 클라이언트 API, 클라이언트의 명령을 이행하고 전체 잡을 스케줄링 및 분배하는 잡트래커가 있다. 또한, 잡트래커의 명령에 따라 각 데이터 노드마다 존재하는, 선택받은 태스크 트래커는 요청받은 만큼의 맵 리듀스 태스크를 실행하게 된다.
